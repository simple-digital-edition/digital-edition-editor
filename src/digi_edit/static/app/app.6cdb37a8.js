(function(e){function t(t){for(var r,i,o=t[0],u=t[1],c=t[2],h=0,d=[];h<o.length;h++)i=o[h],Object.prototype.hasOwnProperty.call(n,i)&&n[i]&&d.push(n[i][0]),n[i]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(e[r]=u[r]);l&&l(t);while(d.length)d.shift()();return s.push.apply(s,c||[]),a()}function a(){for(var e,t=0;t<s.length;t++){for(var a=s[t],r=!0,o=1;o<a.length;o++){var u=a[o];0!==n[u]&&(r=!1)}r&&(s.splice(t--,1),e=i(i.s=a[0]))}return e}var r={},n={app:0},s=[];function i(t){if(r[t])return r[t].exports;var a=r[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=r,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(a,r,function(t){return e[t]}.bind(null,r));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/ui/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],u=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var l=u;s.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("cd49")},cd49:function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var r=a("2b0e"),n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[e.$store.state.busy?a("div",{attrs:{id:"busy"}},[a("progress",{attrs:{max:e.$store.state.maxBusyCounter},domProps:{value:e.$store.state.completedBusyCounter}})]):e._e(),e.$store.state.networkAvailable?e._e():a("div",{staticClass:"error",attrs:{role:"dialog"}},[a("h2",[e._v("Network connection lost")]),a("p",[e._v("The network connection has been lost. This may be due to a local problem in your own network or a problem on the server side. Until network connectivity has been restored you should avoid changing any files, as it will not be possible to save these changes.")]),a("p",[e._v("If you are able to check your own network, then you should check that first, before reporting the issue. If your local network is working, then please contact your administrator.")]),a("p",[e._v("This message will disappear automatically when the network connection has been restored.")])]),a("nav",{staticClass:"main"},[a("aria-menubar",{scopedSlots:e._u([{key:"default",fn:function(t){var r=t.keyboardNav;return[a("ul",{attrs:{role:"menubar"}},[a("li",{attrs:{role:"presentation"}},[a("span",[e._v("Digital Edition Editor")])]),e.$store.state.loggedIn?[a("router-link",{attrs:{to:"/"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.href,s=t.navigate,i=t.isExactActive;return[a("li",{attrs:{role:"presentation"}},[a("a",{attrs:{role:"menuitem",tabindex:"0",href:n,"aria-current":i?"true":"false"},on:{click:s,keyup:r}},[e._v("Edition")])])]}}],null,!0)}),e.branch?a("router-link",{attrs:{to:"/branches/"+e.branch.id},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.href,s=t.navigate,i=t.isExactActive;return[a("li",{attrs:{role:"presentation"}},[a("a",{attrs:{role:"menuitem",tabindex:"-1",href:n,"aria-current":i?"true":"false"},on:{click:s,keyup:r}},[e._v(e._s(e.branch.attributes.name))])])]}}],null,!0)}):e._e(),e.file?a("router-link",{attrs:{to:"/branches/"+e.branch.id+"/files/"+e.file.id},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.href,s=t.navigate,i=t.isExactActive;return[a("li",{attrs:{role:"presentation"}},[a("a",{attrs:{role:"menuitem",tabindex:"-1",href:n,"aria-current":i?"true":"false"},on:{click:s,keyup:r}},[e._v(e._s(e.file.attributes.name))])])]}}],null,!0)}):e._e()]:e._e()],2)]}}])}),a("aria-menubar",{scopedSlots:e._u([{key:"default",fn:function(t){var r=t.keyboardNav;return[a("ul",{attrs:{role:"menubar"}},[a("li",{attrs:{role:"presentation"}},[a("a",{attrs:{role:"menuitem",tabindex:"0"},on:{click:e.toggleHelp,keyup:r}},[e.showHelp?[e._v("Hide ")]:e._e(),e._v("Help")],2)]),e.$store.state.loggedIn?[a("li",{attrs:{role:"presentation"}},[a("a",{attrs:{role:"menuitem",tabindex:"0"},on:{click:e.toggleAbout,keyup:r}},[e._v("About")])]),a("li",{attrs:{role:"presentation"}},[a("a",{attrs:{role:"menuitem",tabindex:"-1"},on:{click:e.logOut,keyup:r}},[e._v("Sign out")])])]:a("router-link",{attrs:{to:"/login"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.href,s=t.navigate,i=t.isExactActive;return[a("li",{attrs:{role:"presentation"}},[a("a",{attrs:{role:"menuitem",tabindex:"0",href:n,"aria-current":i?"true":"false"},on:{click:s,keyup:r}},[e._v("Sign in")])])]}}],null,!0)})],2)]}}])})],1),e.showAbout?a("aria-dialog",[a("div",{attrs:{role:"dialog","aria-modal":"true"},on:{click:e.toggleAbout}},[a("div",{staticClass:"flex"},[a("h2",{staticClass:"shrink"},[e._v("Digital Edition Editor")]),a("ol",{staticClass:"no-bullet expand"},e._l(e.$store.state.config.versions,(function(t){return a("li",{key:t.version,staticClass:"margin-bottom"},[a("h3",[e._v(e._s(t.version)+" ("+e._s(e.fancyDate(t.date))+")")]),a("ul",{staticClass:"no-bullet"},e._l(t.changes,(function(t,r){return a("li",{key:r},["new"===t.type?a("svg",{staticClass:"icon",attrs:{viewBox:"0 0 24 24","aria-label":"New"}},[a("path",{attrs:{d:"M20,4C21.11,4 22,4.89 22,6V18C22,19.11 21.11,20 20,20H4C2.89,20 2,19.11 2,18V6C2,4.89 2.89,4 4,4H20M8.5,15V9H7.25V12.5L4.75,9H3.5V15H4.75V11.5L7.3,15H8.5M13.5,10.26V9H9.5V15H13.5V13.75H11V12.64H13.5V11.38H11V10.26H13.5M20.5,14V9H19.25V13.5H18.13V10H16.88V13.5H15.75V9H14.5V14A1,1 0 0,0 15.5,15H19.5A1,1 0 0,0 20.5,14Z"}})]):"update"===t.type?a("svg",{staticClass:"icon",attrs:{viewBox:"0 0 24 24","aria-label":"Update",title:"Update"}},[a("path",{attrs:{d:"M18.75 22.16L16 19.16L17.16 18L18.75 19.59L22.34 16L23.5 17.41L18.75 22.16M13 13V7H11V13H13M13 17V15H11V17H13M12 2C17.5 2 22 6.5 22 12L21.91 13.31C21.31 13.11 20.67 13 20 13C16.69 13 14 15.69 14 19C14 19.95 14.22 20.85 14.62 21.65C13.78 21.88 12.91 22 12 22C6.5 22 2 17.5 2 12C2 6.5 6.5 2 12 2Z"}})]):"bugfix"===t.type?a("svg",{staticClass:"icon",attrs:{viewBox:"0 0 24 24","aria-label":"Bugfix"}},[a("path",{attrs:{d:"M18,7H15.19C14.74,6.2 14.12,5.5 13.37,5L15,3.41L13.59,2L11.42,4.17C10.96,4.06 10.5,4 10,4C9.5,4 9.05,4.06 8.59,4.17L6.41,2L5,3.41L6.62,5C5.87,5.5 5.26,6.21 4.81,7H2V9H4.09C4.03,9.33 4,9.66 4,10V11H2V13H4V14C4,14.34 4.03,14.67 4.09,15H2V17H4.81C6.26,19.5 9.28,20.61 12,19.65C12,19.43 12,19.22 12,19C12,16.46 13.61,14.2 16,13.35V13H18V11H16V10C16,9.66 15.97,9.33 15.91,9H18V7M12,15H8V13H12V15M12,11H8V9H12V11M17.75,22.16L15,19.16L16.16,18L17.75,19.59L21.34,16L22.5,17.41L17.75,22.16Z"}})]):e._e(),e._v(" "+e._s(t.message))])})),0)])})),0),a("div",{staticClass:"text-right margin-top"},[a("button",{staticClass:"button small",on:{click:e.toggleAbout}},[e._v("Close")])])])])]):e._e(),a("main",{staticClass:"flex"},[a("router-view"),e.showHelp?a("aside",{staticClass:"help flex vertical shrink"},[a("iframe",{staticClass:"expand",attrs:{src:e.helpUrl}})]):e._e()],1)],1)},s=[],i=a("d4ec"),o=a("bee2"),u=a("262e"),c=a("2caf"),l=(a("b0c0"),a("a15b"),a("9ab4")),h=a("1b40"),d=a("b85c"),p=function(e){Object(u["a"])(a,e);var t=Object(c["a"])(a);function a(){return Object(i["a"])(this,a),t.apply(this,arguments)}return Object(o["a"])(a,[{key:"render",value:function(){if(this.$scopedSlots.default)return this.$scopedSlots.default({keyboardNav:this.keyboardNavigation,mouseClickNav:this.mouseClickNavigation})}},{key:"keyboardNavigation",value:function(e){var t=e.target;if(t)if(39===e.keyCode){var a=this.findNextMenuitem(this.getParentMenubar(t),t,"next");a&&a.focus()}else if(37===e.keyCode){var r=this.findNextMenuitem(this.getParentMenubar(t),t,"previous");r&&r.focus()}else if(38===e.keyCode||40===e.keyCode){if(t.parentElement&&t.parentElement.children){var n,s=Object(d["a"])(t.parentElement.children);try{for(s.s();!(n=s.n()).done;){var i=n.value;if("menu"===i.getAttribute("role")){i.setAttribute("aria-hidden","false"),t.setAttribute("aria-expanded","true");var o=this.findNextMenuitem(i,null,"next");o&&o.focus()}}}catch(p){s.e(p)}finally{s.f()}}}else if((13===e.keyCode||32==e.keyCode)&&t.parentElement&&t.parentElement.children){var u,c=Object(d["a"])(t.parentElement.children);try{for(c.s();!(u=c.n()).done;){var l=u.value;if("menu"===l.getAttribute("role"))if("false"===l.getAttribute("aria-hidden"))l.setAttribute("aria-hidden","true"),t.setAttribute("aria-expanded","false");else{l.setAttribute("aria-hidden","false"),t.setAttribute("aria-expanded","true");var h=this.findNextMenuitem(l,null,"next");if(h)return void h.focus()}}}catch(p){c.e(p)}finally{c.f()}t.click()}}},{key:"mouseClickNavigation",value:function(e){var t=e.target;if(t&&t.parentElement&&t.parentElement.children){var a,r=Object(d["a"])(t.parentElement.children);try{for(r.s();!(a=r.n()).done;){var n=a.value;if("menu"===n.getAttribute("role"))if("false"===n.getAttribute("aria-hidden"))n.setAttribute("aria-hidden","true"),t.setAttribute("aria-expanded","false");else{n.setAttribute("aria-hidden","false"),t.setAttribute("aria-expanded","true");var s=this.findNextMenuitem(n,null,"next");if(s)return void s.focus()}}}catch(i){r.e(i)}finally{r.f()}}}},{key:"getParentMenubar",value:function(e){return e?"menubar"===e.getAttribute("role")?e:this.getParentMenubar(e.parentElement):null}},{key:"findNextMenuitem",value:function(e,t,a){if(!e)return null;var r=[];if("next"===a)for(var n=e.children.length-1;n>=0;n--)r.push(e.children[n]);else for(var s=0;s<e.children.length;s++)r.push(e.children[s]);var i=0;t||(i=1);while(r.length>0){var o=r.pop();if(0===i&&o===t)i=1;else if(1===i&&"menuitem"===o.getAttribute("role")&&"true"!==o.getAttribute("aria-disabled"))return o;if("menu"!==o.getAttribute("role"))if("next"===a)for(var u=o.children.length-1;u>=0;u--)r.push(o.children[u]);else for(var c=0;c<o.children.length;c++)r.push(o.children[c])}return null}}]),a}(h["c"]);p=Object(l["a"])([Object(h["a"])({})],p);var f,b,v=p,g=v,m=a("2877"),k=Object(m["a"])(g,f,b,!1,null,null,null),w=k.exports,y=function(e){Object(u["a"])(a,e);var t=Object(c["a"])(a);function a(){return Object(i["a"])(this,a),t.apply(this,arguments)}return Object(o["a"])(a,[{key:"render",value:function(){if(this.$scopedSlots.default)return this.$scopedSlots.default({})}}]),a}(h["c"]);y=Object(l["a"])([h["a"]],y);var C,x,A=y,_=A,O=Object(m["a"])(_,C,x,!1,null,null,null),j=O.exports,L=function(e){Object(u["a"])(a,e);var t=Object(c["a"])(a);function a(){var e;return Object(i["a"])(this,a),e=t.apply(this,arguments),e.showAbout=!1,e.showHelp=!1,e}return Object(o["a"])(a,[{key:"branch",get:function(){return this.$store.state.data.branches&&this.$store.state.data.branches[this.$route.params.bid]?this.$store.state.data.branches[this.$route.params.bid]:null}},{key:"file",get:function(){return this.$store.state.data.files&&this.$store.state.data.files[this.$route.params.fid]?this.$store.state.data.files[this.$route.params.fid]:null}},{key:"helpUrl",get:function(){var e=this.$store.state.config.api.helpURL;return"branch"===this.$route.name?e+="/processes/work_on_file.html":"file"===this.$route.name&&(e+="/editor/index.html"),e}},{key:"fancyDate",value:function(e){var t=new Date(e),a=[];return t.getDate()<10&&a.push("0"),a.push(t.getDate()),a.push("."),t.getMonth()+1<10&&a.push("0"),a.push(t.getMonth()+1),a.push("."),a.push(t.getFullYear()),a.join("")}},{key:"logOut",value:function(){this.$store.commit("setUserId",""),this.$store.commit("setUserToken",""),this.$store.commit("setLoggedIn",!1),this.$router.push({name:"login"})}},{key:"toggleAbout",value:function(e){e.stopPropagation(),this.showAbout=!this.showAbout}},{key:"toggleHelp",value:function(e){e.stopPropagation(),this.showHelp=!this.showHelp}}]),a}(h["c"]);L=Object(l["a"])([Object(h["a"])({components:{AriaMenubar:w,AriaDialog:j}})],L);var V=L,H=V,B=Object(m["a"])(H,n,s,!1,null,null,null),$=B.exports,D=a("8c4f"),M=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"home"},[e.addBranch?a("aria-dialog",[a("div",{attrs:{role:"dialog","aria-modal":"true"}},[a("form",{staticClass:"flex vertical",on:{submit:e.createBranch}},[a("div",[a("h2",[e._v("Add a Task")]),a("label",[e._v("Task Name "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.newBranchName,expression:"newBranchName"}],attrs:{type:"text"},domProps:{value:e.newBranchName},on:{input:function(t){t.target.composing||(e.newBranchName=t.target.value)}}})])]),a("div",{staticClass:"shrink text-right"},[a("a",{attrs:{tabindex:"0"},on:{click:e.toggleAddBranch}},[e._v("Don't add")]),a("button",{staticClass:"button margin-left",attrs:{tabindex:"0"}},[e._v("Add a Task")])])])])]):e._e(),e.addingBranch?a("aria-dialog",[a("div",{attrs:{role:"dialog","aria-modal":"true"}},[a("div",[a("h2",[e._v("Adding a Task")]),a("p",[e._v("The new task is being created. This might take a few minutes.")])])])]):e._e(),a("div",{staticClass:"width-limited"},[a("div",{staticClass:"flex"},[a("h1",[e._v("Edition Tasks")]),a("a",{staticClass:"shrink with-icon",on:{click:e.toggleAddBranch}},[a("svg",{staticClass:"icon small",attrs:{viewBox:"0 0 24 24"}},[a("path",{attrs:{d:"M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M13,7H11V11H7V13H11V17H13V13H17V11H13V7Z"}})]),a("span",[e._v("Add a Task")])])]),a("form",{staticClass:"flex align-end align-bottom margin-bottom"},[a("span",{staticClass:"shrink margin-right"},[a("label",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.showActive,expression:"showActive"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.showActive)?e._i(e.showActive,null)>-1:e.showActive},on:{change:function(t){var a=e.showActive,r=t.target,n=!!r.checked;if(Array.isArray(a)){var s=null,i=e._i(a,s);r.checked?i<0&&(e.showActive=a.concat([s])):i>-1&&(e.showActive=a.slice(0,i).concat(a.slice(i+1)))}else e.showActive=n}}}),e._v(" Active Tasks ")])]),a("span",{staticClass:"shrink margin-right"},[a("label",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.showIntegrated,expression:"showIntegrated"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.showIntegrated)?e._i(e.showIntegrated,null)>-1:e.showIntegrated},on:{change:function(t){var a=e.showIntegrated,r=t.target,n=!!r.checked;if(Array.isArray(a)){var s=null,i=e._i(a,s);r.checked?i<0&&(e.showIntegrated=a.concat([s])):i>-1&&(e.showIntegrated=a.slice(0,i).concat(a.slice(i+1)))}else e.showIntegrated=n}}}),e._v(" Integrated Tasks ")])]),a("span",{staticClass:"shrink"},[a("label",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.showDeleted,expression:"showDeleted"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.showDeleted)?e._i(e.showDeleted,null)>-1:e.showDeleted},on:{change:function(t){var a=e.showDeleted,r=t.target,n=!!r.checked;if(Array.isArray(a)){var s=null,i=e._i(a,s);r.checked?i<0&&(e.showDeleted=a.concat([s])):i>-1&&(e.showDeleted=a.slice(0,i).concat(a.slice(i+1)))}else e.showDeleted=n}}}),e._v(" Deleted Tasks ")])])]),a("dl",{staticClass:"detail-list"},[e._l(e.paginatedBranches,(function(t){return[a("dt",{key:t.id+"-dt",staticClass:"flex"},["active"===t.attributes.status?a("router-link",{attrs:{to:"/branches/"+t.id},scopedSlots:e._u([{key:"default",fn:function(r){var n=r.href,s=r.navigate;return[a("h2",[a("a",{attrs:{href:n},on:{click:s}},[e._v(e._s(t.attributes.name))])])]}}],null,!0)}):a("h2",[e._v(e._s(t.attributes.name))]),a("div",{staticClass:"shrink align-middle"},["active"===t.attributes.status?[t.attributes.updates?a("a",{staticClass:"margin-right-small",attrs:{"aria-label":"Update to latest changes from the primary copy",title:"Update to latest changes from the primary copy"},on:{click:function(a){return e.rebase(t,a)}}},[a("svg",{staticClass:"icon warning",attrs:{viewBox:"0 0 24 24"}},[a("path",{attrs:{d:"M13 14C9.64 14 8.54 15.35 8.18 16.24C9.25 16.7 10 17.76 10 19C10 20.66 8.66 22 7 22S4 20.66 4 19C4 17.69 4.83 16.58 6 16.17V7.83C4.83 7.42 4 6.31 4 5C4 3.34 5.34 2 7 2S10 3.34 10 5C10 6.31 9.17 7.42 8 7.83V13.12C8.88 12.47 10.16 12 12 12C14.67 12 15.56 10.66 15.85 9.77C14.77 9.32 14 8.25 14 7C14 5.34 15.34 4 17 4S20 5.34 20 7C20 8.34 19.12 9.5 17.91 9.86C17.65 11.29 16.68 14 13 14M7 18C6.45 18 6 18.45 6 19S6.45 20 7 20 8 19.55 8 19 7.55 18 7 18M7 4C6.45 4 6 4.45 6 5S6.45 6 7 6 8 5.55 8 5 7.55 4 7 4M17 6C16.45 6 16 6.45 16 7S16.45 8 17 8 18 7.55 18 7 17.55 6 17 6M18 13V14.5C20.21 14.5 22 16.29 22 18.5C22 19.32 21.75 20.08 21.33 20.71L20.24 19.62C20.41 19.28 20.5 18.9 20.5 18.5C20.5 17.12 19.38 16 18 16V17.5L15.75 15.25L15.72 15.22C15.78 15.17 15.85 15.13 18 13M18 24V22.5C15.79 22.5 14 20.71 14 18.5C14 17.68 14.25 16.92 14.67 16.29L15.76 17.38C15.59 17.72 15.5 18.1 15.5 18.5C15.5 19.88 16.62 21 18 21V19.5L20.25 21.75L20.28 21.78C20.22 21.83 20.15 21.87 18 24"}})])]):e._e(),t.attributes.pull_request&&"open"===t.attributes.pull_request.state&&t.attributes.pull_request.reviews&&t.attributes.pull_request.reviews.length>0?a("router-link",{attrs:{to:"/branches/"+t.id},scopedSlots:e._u([{key:"default",fn:function(e){var t=e.href,r=e.navigate;return[a("a",{staticClass:"margin-right",attrs:{href:t,"aria-label":"This task has review comments",title:"This task has review comments"},on:{click:r}},[a("svg",{staticClass:"icon warning",attrs:{viewBox:"0 0 24 24"}},[a("path",{attrs:{d:"M9,22A1,1 0 0,1 8,21V18H4A2,2 0 0,1 2,16V4C2,2.89 2.9,2 4,2H20A2,2 0 0,1 22,4V16A2,2 0 0,1 20,18H13.9L10.2,21.71C10,21.9 9.75,22 9.5,22V22H9M10,16V19.08L13.08,16H20V4H4V16H10M13,10H11V6H13V10M13,14H11V12H13V14Z"}})])])]}}],null,!0)}):e._e(),a("a",{on:{click:function(a){return e.deleteBranch(t)}}},[a("svg",{staticClass:"icon warning",attrs:{viewBox:"0 0 24 24"}},[a("path",{attrs:{d:"M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z"}})])])]:"merged"===t.attributes.status?a("span",{attrs:{title:"This task has been integrated"}},[a("svg",{staticClass:"icon success",attrs:{viewBox:"0 0 24 24"}},[a("path",{attrs:{d:"M6,3A3,3 0 0,1 9,6C9,7.31 8.17,8.42 7,8.83V15.17C8.17,15.58 9,16.69 9,18A3,3 0 0,1 6,21A3,3 0 0,1 3,18C3,16.69 3.83,15.58 5,15.17V8.83C3.83,8.42 3,7.31 3,6A3,3 0 0,1 6,3M6,5A1,1 0 0,0 5,6A1,1 0 0,0 6,7A1,1 0 0,0 7,6A1,1 0 0,0 6,5M6,17A1,1 0 0,0 5,18A1,1 0 0,0 6,19A1,1 0 0,0 7,18A1,1 0 0,0 6,17M21,18A3,3 0 0,1 18,21A3,3 0 0,1 15,18C15,16.69 15.83,15.58 17,15.17V7H15V10.25L10.75,6L15,1.75V5H17A2,2 0 0,1 19,7V15.17C20.17,15.58 21,16.69 21,18M18,17A1,1 0 0,0 17,18A1,1 0 0,0 18,19A1,1 0 0,0 19,18A1,1 0 0,0 18,17Z"}})])]):"deleted"===t.attributes.status?a("span",{attrs:{title:"This task has been deleted"}},[a("svg",{staticClass:"icon warning",attrs:{viewBox:"0 0 24 24"}},[a("path",{attrs:{d:"M6,3A3,3 0 0,1 9,6C9,7.31 8.17,8.42 7,8.83V15.17C8.17,15.58 9,16.69 9,18A3,3 0 0,1 6,21A3,3 0 0,1 3,18C3,16.69 3.83,15.58 5,15.17V8.83C3.83,8.42 3,7.31 3,6A3,3 0 0,1 6,3M6,5A1,1 0 0,0 5,6A1,1 0 0,0 6,7A1,1 0 0,0 7,6A1,1 0 0,0 6,5M6,17A1,1 0 0,0 5,18A1,1 0 0,0 6,19A1,1 0 0,0 7,18A1,1 0 0,0 6,17M21,18A3,3 0 0,1 18,21A3,3 0 0,1 15,18C15,16.69 15.83,15.58 17,15.17V7H15V10.25L10.75,6L15,1.75V5H17A2,2 0 0,1 19,7V15.17C20.17,15.58 21,16.69 21,18M18,17A1,1 0 0,0 17,18A1,1 0 0,0 18,19A1,1 0 0,0 19,18A1,1 0 0,0 18,17Z"}})])]):e._e()],2)],1),a("dd",{key:t.id+"-dd"},[a("span",[e._v("Started at: "+e._s(e.fancyDate(t.attributes.created)))]),t.attributes.updated?a("span",[[e._v("Last Change: "+e._s(e.fancyDate(t.attributes.updated)))]],2):t.attributes.merged?a("span",[[e._v("Integrated: "+e._s(e.fancyDate(t.attributes.merged)))]],2):t.attributes.deleted?a("span",[[e._v("Deleted: "+e._s(e.fancyDate(t.attributes.deleted)))]],2):a("span"),a("span",[t.attributes.authors&&t.attributes.authors.length>0?[e._v("Changes By: "+e._s(t.attributes.authors.join(", ")))]:e._e()],2)])]}))],2),a("div",{staticClass:"flex"},[a("span",[e.taskPage>0?a("a",{on:{click:function(t){return e.paginate(-1)}}},[e._v("« Previous Page")]):a("span",{staticClass:"disabled"},[e._v("« Previous Page")])]),a("span",{staticClass:"text-center"},[e._v(e._s(10*e.taskPage+1)+" - "+e._s(Math.min(10*(e.taskPage+1),e.branches.length)))]),a("span",{staticClass:"text-right"},[e.taskPage<Math.ceil(e.branches.length/10)-1?a("a",{on:{click:function(t){return e.paginate(1)}}},[e._v("Next Page »")]):a("span",{staticClass:"disabled"},[e._v("Next Page »")])])])])],1)},R=[],I=a("1da1"),T=(a("96cf"),a("07ac"),a("4de4"),a("fb6a"),function(e){Object(u["a"])(a,e);var t=Object(c["a"])(a);function a(){var e;return Object(i["a"])(this,a),e=t.apply(this,arguments),e.intervalId=-1,e.addBranch=!1,e.addingBranch=!1,e.newBranchName="",e.showActive=!0,e.showIntegrated=!1,e.showDeleted=!1,e.taskPage=0,e}return Object(o["a"])(a,[{key:"branches",get:function(){var e=this;if(this.$store.state.data.branches){var t=Object.values(this.$store.state.data.branches);return t=t.filter((function(t){return!(!e.showActive||"active"!==t.attributes.status)||(!(!e.showIntegrated||"merged"!==t.attributes.status)||!(!e.showDeleted||"deleted"!==t.attributes.status))})),t.sort((function(e,t){var a,r;if(e.attributes.updated?a=new Date(e.attributes.updated):e.attributes.merged?a=new Date(e.attributes.merged):e.attributes.deleted?a=new Date(e.attributes.deleted):e.attributes.created&&(a=new Date(e.attributes.created)),t.attributes.updated?r=new Date(t.attributes.updated):t.attributes.merged?r=new Date(t.attributes.merged):t.attributes.deleted?r=new Date(t.attributes.deleted):t.attributes.created&&(r=new Date(t.attributes.created)),a&&r){if(a>r)return-1;if(a<r)return 1}return e.attributes.title<t.attributes.title?-1:e.attributes.title>t.attributes.title?1:0})),t}return[]}},{key:"paginatedBranches",get:function(){var e=this.branches;return 10*this.taskPage>e.length&&(this.taskPage=0),e.slice(10*this.taskPage,10*(this.taskPage+1))}},{key:"mounted",value:function(){var e=this;this.intervalId=window.setInterval(Object(I["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("backgroundFetchAll","branches");case 2:case"end":return t.stop()}}),t)}))),6e4)}},{key:"beforeDestroy",value:function(){window.clearInterval(this.intervalId)}},{key:"toggleAddBranch",value:function(e){e.preventDefault(),this.addBranch=!this.addBranch}},{key:"createBranch",value:function(){var e=Object(I["a"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,this.addBranch=!1,this.addingBranch=!0,e.next=6,this.$store.dispatch("createBranch",{type:"branches",attributes:{name:this.newBranchName}});case 6:a=e.sent,this.addingBranch=!0,this.$router.push({name:"branch",params:{bid:a.id}}),e.next=15;break;case 11:e.prev=11,e.t0=e["catch"](1),alert("Unfortunately something went wrong creating a new task"),this.addingBranch=!1;case 15:case"end":return e.stop()}}),e,this,[[1,11]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"deleteBranch",value:function(){var e=Object(I["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:confirm("Deleting this task ("+t.attributes.name+") will also delete any changes that have been made there and that have not been integrated into the default copy.\n\nThis cannot be undone.\n\nPlease confirm you wish to proceed.")&&this.$store.dispatch("deleteBranch",t);case 1:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"fancyDate",value:function(e){var t=new Date(e),a=[];return t.getDate()<10&&a.push("0"),a.push(t.getDate()),a.push("."),t.getMonth()+1<10&&a.push("0"),a.push(t.getMonth()+1),a.push("."),a.push(t.getFullYear()),a.push(" at "),t.getHours()<10&&a.push("0"),a.push(t.getHours()),a.push(":"),t.getMinutes()<10&&a.push("0"),a.push(t.getMinutes()),a.join("")}},{key:"rebase",value:function(){var e=Object(I["a"])(regeneratorRuntime.mark((function e(t,a){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a.preventDefault(),!t){e.next=4;break}return e.next=4,this.$store.dispatch("action",{obj:t,action:"rebase"});case 4:case"end":return e.stop()}}),e,this)})));function t(t,a){return e.apply(this,arguments)}return t}()},{key:"paginate",value:function(e){this.taskPage=Math.min(Math.max(0,this.taskPage+e),Math.ceil(this.branches.length/10)-1)}}]),a}(h["c"]));T=Object(l["a"])([Object(h["a"])({components:{AriaDialog:j}})],T);var S=T,F=S,N=Object(m["a"])(F,M,R,!1,null,null,null),U=N.exports,P=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"login width-limited margin-top"},[a("h1",[e._v("Sign in")]),a("form",{staticClass:"flex",on:{submit:e.login}},[a("label",[e._v("E-Mail Address "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.email,expression:"email"}],attrs:{type:"email"},domProps:{value:e.email},on:{input:function(t){t.target.composing||(e.email=t.target.value)}}}),e.errors.email?a("span",{staticClass:"error-msg"},[e._v(e._s(e.errors.email))]):e._e()]),a("label",[e._v("Password "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],attrs:{type:"password"},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}}),e.errors.password?a("span",{staticClass:"error-msg"},[e._v(e._s(e.errors.email))]):e._e()]),a("span",{staticClass:"align-end shrink"},[a("button",{staticClass:"button"},[e._v("Sign in")]),e.errors.email||e.errors.password?a("span",{staticClass:"error-msg empty"}):e._e()])])])},E=[],q=a("ade3"),Z=(a("ac1f"),a("1276"),a("d81d"),a("d3b7"),a("3ca3"),a("ddb0"),a("159b"),a("2f62")),X=a("bc3a"),z=a.n(X),G=a("694b"),J=a.n(G);function Y(e,t,a){var r={},n=e.getItem("digi_edit:storage");n&&(r=JSON.parse(n));for(var s=t.split("."),i=r,o=0;o<s.length;o++){var u=s[o];o===s.length-1?i[u]=a:(i[u]||(i[u]={}),i=i[u])}e.setItem("digi_edit:storage",JSON.stringify(r))}function K(e,t,a){var r=e.getItem("digi_edit:storage");if(r)for(var n=JSON.parse(r),s=t.split("."),i=n,o=0;o<s.length;o++){var u=s[o];if(o===s.length-1)return void 0!==i[u]?i[u]:a;if(!i[u])return a;i=i[u]}return a}function Q(e,t){Y(sessionStorage,e,t)}function W(e,t){return K(sessionStorage,e,t)}function ee(e){return e.response?e.response.data.errors.reduce((function(e,t){var a=t.source.pointer.split("/");return e[a[a.length-1]]=t.title,e}),{}):{}}r["a"].use(Z["a"]);var te=new Z["a"].Store({state:{config:{api:{baseURL:"",configURL:"",changesURL:"",helpURL:""},versions:[]},data:{},userId:"",userToken:"",loggedIn:!1,busy:!1,busyCounter:0,maxBusyCounter:0,completedBusyCounter:0,networkAvailable:!0},mutations:{setConfig:function(e,t){e.config=t},setConfigSection:function(e,t){r["a"].set(e.config,t.type,t.data)},setVersions:function(e,t){r["a"].set(e.config,"versions",t)},setUserId:function(e,t){e.userId=t,Q("user.id",t)},setUserToken:function(e,t){e.userToken=t,Q("user.token",t)},setLoggedIn:function(e,t){e.loggedIn=t,Q("user.loggedIn",t)},setObject:function(e,t){e.data[t.type]?e.data[t.type][t.id]&&J()(t,e.data[t.type][t.id])||r["a"].set(e.data[t.type],t.id,t):r["a"].set(e.data,t.type,Object(q["a"])({},t.id,t))},deleteObject:function(e,t){e.data[t.type]&&r["a"].delete(e.data[t.type],t.id)},setBusy:function(e,t){t?(e.busyCounter=e.busyCounter+1,e.maxBusyCounter=e.maxBusyCounter+1):(e.busyCounter=e.busyCounter-1,e.completedBusyCounter=e.completedBusyCounter+1),0===e.busyCounter?setTimeout((function(){e.busy=!1,e.maxBusyCounter=0,e.completedBusyCounter=0}),300):e.busy=!0},setNetworkAvailable:function(e,t){e.networkAvailable=t}},actions:{init:function(e){return Object(I["a"])(regeneratorRuntime.mark((function t(){var a,r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=e.dispatch,r=e.commit,n=e.state,r("setUserId",W("user.id","")),r("setUserToken",W("user.token","")),r("setLoggedIn",W("user.loggedIn","")),a("loadConfig","tei-schema"),a("loadChanges"),!n.loggedIn||""===n.userId||""===n.userToken){t.next=13;break}return t.next=9,a("loadUser");case 9:return t.next=11,a("loadBranches");case 11:t.next=14;break;case 13:Se.push({name:"login"});case 14:case"end":return t.stop()}}),t)})))()},loadConfig:function(e,t){return Object(I["a"])(regeneratorRuntime.mark((function a(){var r,n,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=e.commit,n=e.state,a.prev=1,r("setBusy",!0),a.next=5,z.a.get(n.config.api.configURL+"/tei-schema");case 5:s=a.sent,r("setConfigSection",{type:t,data:s.data}),r("setBusy",!1),a.next=13;break;case 10:a.prev=10,a.t0=a["catch"](1),r("setBusy",!1);case 13:case"end":return a.stop()}}),a,null,[[1,10]])})))()},loadChanges:function(e){return Object(I["a"])(regeneratorRuntime.mark((function t(){var a,r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.commit,r=e.state,t.next=3,z()({method:"GET",url:r.config.api.changesURL});case 3:n=t.sent.data,a("setVersions",n);case 5:case"end":return t.stop()}}),t)})))()},loadUser:function(e){return Object(I["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.dispatch,r=e.state,t.next=3,a("fetchSingle",{type:"users",id:r.userId});case 3:case"end":return t.stop()}}),t)})))()},loadBranches:function(e){return Object(I["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.dispatch,t.next=3,a("fetchAll","branches");case 3:return r=t.sent,t.abrupt("return",r);case 5:case"end":return t.stop()}}),t)})))()},createBranch:function(e,t){return Object(I["a"])(regeneratorRuntime.mark((function a(){var r,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=e.dispatch,a.next=3,r("createSingle",t);case 3:return t=a.sent,n=t.relationships.files.data.map((function(e){return r("loadFile",e)})),a.next=7,Promise.all(n);case 7:return a.abrupt("return",t);case 8:case"end":return a.stop()}}),a)})))()},loadBranch:function(e,t){return Object(I["a"])(regeneratorRuntime.mark((function a(){var r,n,s,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(r=e.dispatch,n=e.state,!(n.data.branches&&t.id&&n.data.branches[t.id])){a.next=11;break}return a.next=4,r("backgroundFetchSingle",t);case 4:return t=a.sent,s=t.relationships.files.data.map((function(e){return r("loadFile",e)})),a.next=8,Promise.all(s);case 8:return a.abrupt("return",t);case 11:return a.next=13,r("fetchSingle",t);case 13:return t=a.sent,i=t.relationships.files.data.map((function(e){return r("loadFile",e)})),a.next=17,Promise.all(i);case 17:return a.abrupt("return",t);case 18:case"end":return a.stop()}}),a)})))()},deleteBranch:function(e,t){return Object(I["a"])(regeneratorRuntime.mark((function a(){var r,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=e.dispatch,n=e.commit,a.next=3,r("deleteSingle",t);case 3:t.relationships.files.data.forEach((function(e){n("deleteObject",e)}));case 4:case"end":return a.stop()}}),a)})))()},loadFile:function(e,t){return Object(I["a"])(regeneratorRuntime.mark((function a(){var r,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(r=e.dispatch,n=e.state,!(n.data.files&&t.id&&n.data.files[t.id])){a.next=7;break}return a.next=4,r("backgroundFetchSingle",t);case 4:return a.abrupt("return",a.sent);case 7:return a.next=9,r("fetchSingle",t);case 9:return a.abrupt("return",a.sent);case 10:case"end":return a.stop()}}),a)})))()},fetchAll:function(e,t){return Object(I["a"])(regeneratorRuntime.mark((function a(){var r,n,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=e.commit,n=e.state,a.prev=1,r("setBusy",!0),a.next=5,z()({method:"GET",url:n.config.api.baseURL+"/"+t,headers:{"X-Authorization":n.userId+" "+n.userToken}});case 5:return s=a.sent.data,r("setNetworkAvailable",!0),s.data.forEach((function(e){r("setObject",e)})),r("setBusy",!1),a.abrupt("return",s.data);case 12:if(a.prev=12,a.t0=a["catch"](1),r("setBusy",!1),!a.t0.response||401!==a.t0.response.status){a.next=22;break}r("setUserId",""),r("setUserToken",""),r("setLoggedIn",""),Se.push({name:"login"}),a.next=24;break;case 22:throw r("setNetworkAvailable",!1),a.t0;case 24:case"end":return a.stop()}}),a,null,[[1,12]])})))()},backgroundFetchAll:function(e,t){return Object(I["a"])(regeneratorRuntime.mark((function a(){var r,n,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=e.commit,n=e.state,a.prev=1,a.next=4,z()({method:"GET",url:n.config.api.baseURL+"/"+t,headers:{"X-Authorization":n.userId+" "+n.userToken}});case 4:return s=a.sent.data,r("setNetworkAvailable",!0),s.data.forEach((function(e){r("setObject",e)})),a.abrupt("return",s.data);case 10:if(a.prev=10,a.t0=a["catch"](1),!a.t0.response||401!==a.t0.response.status){a.next=19;break}r("setUserId",""),r("setUserToken",""),r("setLoggedIn",""),Se.push({name:"login"}),a.next=21;break;case 19:throw r("setNetworkAvailable",!1),a.t0;case 21:case"end":return a.stop()}}),a,null,[[1,10]])})))()},fetchSingle:function(e,t){return Object(I["a"])(regeneratorRuntime.mark((function a(){var r,n,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=e.commit,n=e.state,a.prev=1,r("setBusy",!0),a.next=5,z()({method:"GET",url:n.config.api.baseURL+"/"+t.type+"/"+t.id,headers:{"X-Authorization":n.userId+" "+n.userToken}});case 5:return s=a.sent.data.data,r("setNetworkAvailable",!0),r("setObject",s),r("setBusy",!1),a.abrupt("return",s);case 12:if(a.prev=12,a.t0=a["catch"](1),r("setBusy",!1),!a.t0.response||401!==a.t0.response.status){a.next=22;break}r("setUserId",""),r("setUserToken",""),r("setLoggedIn",""),Se.push({name:"login"}),a.next=24;break;case 22:throw r("setNetworkAvailable",!1),a.t0;case 24:case"end":return a.stop()}}),a,null,[[1,12]])})))()},backgroundFetchSingle:function(e,t){return Object(I["a"])(regeneratorRuntime.mark((function a(){var r,n,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=e.commit,n=e.state,a.prev=1,a.next=4,z()({method:"GET",url:n.config.api.baseURL+"/"+t.type+"/"+t.id,headers:{"X-Authorization":n.userId+" "+n.userToken}});case 4:return s=a.sent.data.data,r("setNetworkAvailable",!0),r("setObject",s),a.abrupt("return",s);case 10:if(a.prev=10,a.t0=a["catch"](1),!a.t0.response||401!==a.t0.response.status){a.next=19;break}r("setUserId",""),r("setUserToken",""),r("setLoggedIn",""),Se.push({name:"login"}),a.next=21;break;case 19:throw r("setNetworkAvailable",!1),a.t0;case 21:case"end":return a.stop()}}),a,null,[[1,10]])})))()},createSingle:function(e,t){return Object(I["a"])(regeneratorRuntime.mark((function a(){var r,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=e.commit,n=e.state,a.prev=1,r("setBusy",!0),a.next=5,z()({method:"POST",url:n.config.api.baseURL+"/"+t.type,data:{data:t},headers:{"X-Authorization":n.userId+" "+n.userToken}});case 5:return t=a.sent.data.data,r("setNetworkAvailable",!0),r("setObject",t),r("setBusy",!1),a.abrupt("return",t);case 12:if(a.prev=12,a.t0=a["catch"](1),r("setBusy",!1),!a.t0.response||401!==a.t0.response.status){a.next=22;break}r("setUserId",""),r("setUserToken",""),r("setLoggedIn",""),Se.push({name:"login"}),a.next=24;break;case 22:throw r("setNetworkAvailable",!1),a.t0;case 24:case"end":return a.stop()}}),a,null,[[1,12]])})))()},saveSingle:function(e,t){return Object(I["a"])(regeneratorRuntime.mark((function a(){var r,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=e.commit,n=e.state,a.prev=1,r("setBusy",!0),a.next=5,z()({method:"PATCH",url:n.config.api.baseURL+"/"+t.type+"/"+t.id,data:{data:t},headers:{"X-Authorization":n.userId+" "+n.userToken}});case 5:return t=a.sent.data.data,r("setNetworkAvailable",!0),r("setObject",t),r("setBusy",!1),a.abrupt("return",t);case 12:if(a.prev=12,a.t0=a["catch"](1),r("setBusy",!1),!a.t0.response||401!==a.t0.response.status){a.next=22;break}r("setUserId",""),r("setUserToken",""),r("setLoggedIn",""),Se.push({name:"login"}),a.next=24;break;case 22:throw r("setNetworkAvailable",!1),a.t0;case 24:case"end":return a.stop()}}),a,null,[[1,12]])})))()},deleteSingle:function(e,t){return Object(I["a"])(regeneratorRuntime.mark((function a(){var r,n,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=e.commit,n=e.state,a.prev=1,r("setBusy",!0),a.next=5,z()({method:"DELETE",url:n.config.api.baseURL+"/"+t.type+"/"+t.id,headers:{"X-Authorization":n.userId+" "+n.userToken}});case 5:s=a.sent,r("setNetworkAvailable",!0),200===s.status?r("setObject",s.data.data):r("deleteObject",t),r("setBusy",!1),a.next=23;break;case 11:if(a.prev=11,a.t0=a["catch"](1),r("setBusy",!1),!a.t0.response||401!==a.t0.response.status){a.next=21;break}r("setUserId",""),r("setUserToken",""),r("setLoggedIn",""),Se.push({name:"login"}),a.next=23;break;case 21:throw r("setNetworkAvailable",!1),a.t0;case 23:case"end":return a.stop()}}),a,null,[[1,11]])})))()},login:function(e,t){return Object(I["a"])(regeneratorRuntime.mark((function a(){var r,n,s,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=e.dispatch,n=e.commit,s=e.state,a.prev=1,n("setBusy",!0),a.next=5,z()({method:"POST",url:s.config.api.baseURL+"/login",data:{data:{type:"users",attributes:t}},headers:{"X-Authorization":s.userId+" "+s.userToken}});case 5:return i=a.sent,n("setNetworkAvailable",!0),n("setUserId",i.data.id),n("setUserToken",i.data.attributes.token),n("setLoggedIn",!0),a.next=12,r("init");case 12:Se.push({name:"root"}),n("setBusy",!1),a.next=20;break;case 16:throw a.prev=16,a.t0=a["catch"](1),n("setBusy",!1),a.t0;case 20:case"end":return a.stop()}}),a,null,[[1,16]])})))()},action:function(e,t){return Object(I["a"])(regeneratorRuntime.mark((function a(){var r,n,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=e.commit,n=e.state,a.prev=1,r("setBusy",!0),a.next=5,z()({method:"POST",url:n.config.api.baseURL+"/"+t.obj.type+"/"+t.obj.id,headers:{"X-Authorization":n.userId+" "+n.userToken,"X-Action":t.action}});case 5:return s=a.sent.data.data,r("setNetworkAvailable",!0),r("setObject",s),r("setBusy",!1),a.abrupt("return",s);case 12:if(a.prev=12,a.t0=a["catch"](1),r("setBusy",!1),!a.t0.response||401!==a.t0.response.status){a.next=22;break}r("setUserId",""),r("setUserToken",""),r("setLoggedIn",""),Se.push({name:"login"}),a.next=24;break;case 22:throw r("setNetworkAvailable",!1),a.t0;case 24:case"end":return a.stop()}}),a,null,[[1,12]])})))()}},modules:{}}),ae=function(e){Object(u["a"])(a,e);var t=Object(c["a"])(a);function a(){var e;return Object(i["a"])(this,a),e=t.apply(this,arguments),e.email="",e.password="",e.errors={},e}return Object(o["a"])(a,[{key:"login",value:function(){var e=Object(I["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,this.errors={},e.next=5,this.$store.dispatch("login",{email:this.email,password:this.password});case 5:e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](1),this.errors=ee(e.t0);case 10:case"end":return e.stop()}}),e,this,[[1,7]])})));function t(t){return e.apply(this,arguments)}return t}()}]),a}(h["c"]);ae=Object(l["a"])([h["a"]],ae);var re=ae,ne=re,se=Object(m["a"])(ne,P,E,!1,null,null,null),ie=se.exports,oe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.isCurrentRoute?a("div",{staticClass:"branch-overview"},[e.flash?a("div",{staticClass:"flash flex"},[a("p",[e._v(e._s(e.flash))]),a("a",{staticClass:"shrink",on:{click:function(t){return e.setFlash("")}}},[a("svg",{staticClass:"icon small",attrs:{viewBox:"0 0 24 24"}},[a("path",{attrs:{d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"}})])])]):e._e(),e.newFileDirectory?a("aria-dialog",[a("div",{attrs:{role:"dialog","aria-modal":"true"}},[a("form",{staticClass:"flex vertical",on:{submit:e.createFile}},[a("div",[a("h2",[e._v("Create a File")]),a("label",[e._v("Directory the file will be added to "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.newFileDirectory,expression:"newFileDirectory"}],attrs:{type:"text",readonly:"readonly"},domProps:{value:e.newFileDirectory},on:{input:function(t){t.target.composing||(e.newFileDirectory=t.target.value)}}})]),a("label",[e._v("Filename of the new file "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.newFileName,expression:"newFileName"}],attrs:{type:"text"},domProps:{value:e.newFileName},on:{input:function(t){t.target.composing||(e.newFileName=t.target.value)}}})])]),a("div",{staticClass:"shrink text-right"},[a("a",{attrs:{tabindex:"0"},on:{click:e.cancelAddFile}},[e._v("Don't add")]),a("button",{staticClass:"button margin-left",attrs:{tabindex:"0"}},[e._v("Add the File")])])])])]):e._e(),e.branch?a("div",{staticClass:"width-limited"},["active"===e.branch.attributes.status?[a("div",{staticClass:"flex"},[a("h1",{staticClass:"no-margin"},[e._v(e._s(e.branch.attributes.name))]),a("aria-menubar",{scopedSlots:e._u([{key:"default",fn:function(t){var r=t.keyboardNav;return[a("ul",{staticClass:"shrink transparent",attrs:{role:"menubar"}},[e.branch.attributes.updates?a("li",{attrs:{role:"presentation"}},[a("a",{attrs:{role:"menuitem",tabindex:"0","aria-label":"Update to latest changes from the primary copy",title:"Update to latest changes from the primary copy"},on:{keyup:r,click:e.rebase}},[a("svg",{staticClass:"icon warning",attrs:{viewBox:"0 0 24 24"}},[a("path",{attrs:{d:"M13 14C9.64 14 8.54 15.35 8.18 16.24C9.25 16.7 10 17.76 10 19C10 20.66 8.66 22 7 22S4 20.66 4 19C4 17.69 4.83 16.58 6 16.17V7.83C4.83 7.42 4 6.31 4 5C4 3.34 5.34 2 7 2S10 3.34 10 5C10 6.31 9.17 7.42 8 7.83V13.12C8.88 12.47 10.16 12 12 12C14.67 12 15.56 10.66 15.85 9.77C14.77 9.32 14 8.25 14 7C14 5.34 15.34 4 17 4S20 5.34 20 7C20 8.34 19.12 9.5 17.91 9.86C17.65 11.29 16.68 14 13 14M7 18C6.45 18 6 18.45 6 19S6.45 20 7 20 8 19.55 8 19 7.55 18 7 18M7 4C6.45 4 6 4.45 6 5S6.45 6 7 6 8 5.55 8 5 7.55 4 7 4M17 6C16.45 6 16 6.45 16 7S16.45 8 17 8 18 7.55 18 7 17.55 6 17 6M18 13V14.5C20.21 14.5 22 16.29 22 18.5C22 19.32 21.75 20.08 21.33 20.71L20.24 19.62C20.41 19.28 20.5 18.9 20.5 18.5C20.5 17.12 19.38 16 18 16V17.5L15.75 15.25L15.72 15.22C15.78 15.17 15.85 15.13 18 13M18 24V22.5C15.79 22.5 14 20.71 14 18.5C14 17.68 14.25 16.92 14.67 16.29L15.76 17.38C15.59 17.72 15.5 18.1 15.5 18.5C15.5 19.88 16.62 21 18 21V19.5L20.25 21.75L20.28 21.78C20.22 21.83 20.15 21.87 18 24"}})])])]):e._e(),a("li",{attrs:{role:"presentation"}},[e.branch.attributes.pull_request&&"open"===e.branch.attributes.pull_request.state?a("a",{attrs:{role:"menuitem",tabindex:e.branch.attributes.updates?-1:0,"aria-label":"Cancel the integration",title:"Cancel the integration"},on:{keyup:r,click:e.cancelIntegration}},[a("svg",{staticClass:"icon warning",attrs:{viewBox:"0 0 24 24"}},[a("path",{attrs:{d:"M6,3A3,3 0 0,1 9,6C9,7.31 8.17,8.42 7,8.83V15.17C8.17,15.58 9,16.69 9,18A3,3 0 0,1 6,21A3,3 0 0,1 3,18C3,16.69 3.83,15.58 5,15.17V8.83C3.83,8.42 3,7.31 3,6A3,3 0 0,1 6,3M6,5A1,1 0 0,0 5,6A1,1 0 0,0 6,7A1,1 0 0,0 7,6A1,1 0 0,0 6,5M6,17A1,1 0 0,0 5,18A1,1 0 0,0 6,19A1,1 0 0,0 7,18A1,1 0 0,0 6,17M17.17,11.77V7H15V10.25L10.75,6L15,1.75V5H17A2,2 0 0,1 19,7V11.77H17.17M17.5 13C15 13 13 15 13 17.5C13 20 15 22 17.5 22C20 22 22 20 22 17.5C22 15 20 13 17.5 13M17.5 14.5C19.16 14.5 20.5 15.84 20.5 17.5C20.5 18.06 20.35 18.58 20.08 19L16 14.92C16.42 14.65 16.94 14.5 17.5 14.5M14.92 16L19 20.08C18.58 20.35 18.06 20.5 17.5 20.5C15.84 20.5 14.5 19.16 14.5 17.5C14.5 16.94 14.65 16.42 14.92 16Z"}})])]):a("a",{attrs:{role:"menuitem",tabindex:e.branch.attributes.updates?-1:0,"aria-label":"Request integration into the primary copy",title:"Request integration into the primary copy"},on:{keyup:r,click:e.requestIntegration}},[a("svg",{staticClass:"icon",attrs:{viewBox:"0 0 24 24"}},[a("path",{attrs:{d:"M6,3A3,3 0 0,1 9,6C9,7.31 8.17,8.42 7,8.83V15.17C8.17,15.58 9,16.69 9,18A3,3 0 0,1 6,21A3,3 0 0,1 3,18C3,16.69 3.83,15.58 5,15.17V8.83C3.83,8.42 3,7.31 3,6A3,3 0 0,1 6,3M6,5A1,1 0 0,0 5,6A1,1 0 0,0 6,7A1,1 0 0,0 7,6A1,1 0 0,0 6,5M6,17A1,1 0 0,0 5,18A1,1 0 0,0 6,19A1,1 0 0,0 7,18A1,1 0 0,0 6,17M21,18A3,3 0 0,1 18,21A3,3 0 0,1 15,18C15,16.69 15.83,15.58 17,15.17V7H15V10.25L10.75,6L15,1.75V5H17A2,2 0 0,1 19,7V15.17C20.17,15.58 21,16.69 21,18M18,17A1,1 0 0,0 17,18A1,1 0 0,0 18,19A1,1 0 0,0 19,18A1,1 0 0,0 18,17Z"}})])])]),a("li",{attrs:{role:"presentation"}},[a("a",{attrs:{role:"menuitem",tabindex:"-1","aria-label":"Reload all files",title:"Reload all files"},on:{keyup:r,click:e.rescan}},[a("svg",{staticClass:"icon",attrs:{viewBox:"0 0 24 24"}},[a("path",{attrs:{d:"M17.65,6.35C16.2,4.9 14.21,4 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20C15.73,20 18.84,17.45 19.73,14H17.65C16.83,16.33 14.61,18 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6C13.66,6 15.14,6.69 16.22,7.78L13,11H20V4L17.65,6.35Z"}})])])]),a("li",{attrs:{role:"presentation"}},[a("a",{attrs:{role:"menuitem",tabindex:"-1","aria-label":"Delete this task",title:"Delete this task"},on:{keyup:r,click:e.deleteBranch}},[a("svg",{staticClass:"icon warning",attrs:{viewBox:"0 0 24 24"}},[a("path",{attrs:{d:"M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z"}})])])])])]}}],null,!1,2981003276)})],1),a("aria-menubar",{scopedSlots:e._u([{key:"default",fn:function(t){var r=t.keyboardNav;return[a("ul",{staticClass:"transparent",attrs:{role:"menubar"}},[e.branch.attributes.changes&&e.branch.attributes.changes.length>0?a("li",{attrs:{role:"presentation"}},[a("a",{attrs:{role:"menuitem","aria-current":"changed"===e.mode?"true":"false"},on:{keyup:r,click:function(t){return e.setMode("changed")}}},[e._v("Changed Files")])]):e._e(),a("li",{attrs:{role:"presentation"}},[a("a",{attrs:{role:"menuitem","aria-current":"files"===e.mode?"true":"false"},on:{keyup:r,click:function(t){return e.setMode("files")}}},[e._v("All Files")])]),e.branch.attributes.pull_request&&"open"===e.branch.attributes.pull_request.state&&e.branch.attributes.pull_request.reviews&&e.branch.attributes.pull_request.reviews.length>0?a("li",{attrs:{role:"presentation"}},[a("a",{attrs:{role:"menuitem","aria-current":"integration"===e.mode?"true":"false"},on:{keyup:r,click:function(t){return e.setMode("integration")}}},[e._v("Integration Reviews")])]):e._e(),"files"===e.mode?[a("li",{staticClass:"expander",attrs:{role:"presentation"}}),a("li",{attrs:{role:"presentation"}},[a("form",{staticClass:"flex file-filter",on:{submit:function(e){return e.preventDefault()}}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.fileFilter,expression:"fileFilter"}],attrs:{type:"search"},domProps:{value:e.fileFilter},on:{input:function(t){t.target.composing||(e.fileFilter=t.target.value)}}}),a("svg",{staticClass:"icon",attrs:{viewBox:"0 0 24 24"}},[a("path",{attrs:{d:"M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"}})])])])]:e._e()],2)]}}],null,!1,2719348216)}),"changed"===e.mode?a("dl",{staticClass:"detail-list margin-top"},[e._l(e.changedSets,(function(t,r){return[a("dt",{key:r+"-dt",staticClass:"flex"},[a("h2",{staticClass:"expand",attrs:{title:t.id}},[e._v(e._s(e.ellipsisPath(t.id,55)))]),"Loading..."!==t.id?a("button",{staticClass:"button small clear shrink",attrs:{"aria-label":"Add a file here",title:"Add a file here"},on:{click:function(a){return e.addFile(t.id)}}},[a("svg",{staticClass:"icon",attrs:{viewBox:"0 0 24 24"}},[a("path",{attrs:{d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"}})])]):e._e()]),a("dd",{key:r+"-dd"},[a("ul",{staticClass:"no-bullet"},e._l(t.files,(function(t){return a("li",{key:t.id},[a("router-link",{attrs:{to:"/branches/"+e.branch.id+"/files/"+t.id},scopedSlots:e._u([{key:"default",fn:function(r){var n=r.href,s=r.navigate;return[a("a",{attrs:{href:n},on:{click:s}},[e._v(e._s(t.attributes.name))])]}}],null,!0)})],1)})),0)])]}))],2):"files"===e.mode?a("dl",{staticClass:"detail-list margin-top"},[e._l(e.fileSets,(function(t,r){return[a("dt",{key:r+"-dt",staticClass:"flex"},[a("h2",{staticClass:"expand",attrs:{title:t.id}},[e._v(e._s(e.ellipsisPath(t.id,55)))]),"Loading..."!==t.id?a("button",{staticClass:"button small clear shrink",attrs:{"aria-label":"Add a file here",title:"Add a file here"},on:{click:function(a){return e.addFile(t.id)}}},[a("svg",{staticClass:"icon",attrs:{viewBox:"0 0 24 24"}},[a("path",{attrs:{d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"}})])]):e._e()]),a("dd",{key:r+"-dd"},[a("ul",{staticClass:"no-bullet"},e._l(t.files,(function(t){return a("li",{key:t.id},[a("router-link",{attrs:{to:"/branches/"+e.branch.id+"/files/"+t.id},scopedSlots:e._u([{key:"default",fn:function(r){var n=r.href,s=r.navigate;return[a("a",{attrs:{href:n},on:{click:s}},[e._v(e._s(t.attributes.name))])]}}],null,!0)})],1)})),0)])]}))],2):"integration"===e.mode?a("dl",{staticClass:"detail-list margin-top"},[e._l(e.branch.attributes.pull_request.reviews,(function(t,r){return[a("dt",{key:r+"-dt",staticClass:"flex"},[a("h2",[e._v(e._s(t.user))]),"APPROVED"===t.state?a("svg",{staticClass:"shrink icon success",attrs:{viewBox:"0 0 24 24"}},[a("path",{attrs:{d:"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"}})]):""!==t.state?a("svg",{staticClass:"shrink icon warning",attrs:{viewBox:"0 0 24 24"}},[a("path",{attrs:{d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"}})]):e._e()]),a("dd",{key:r+"-dd"},[e._v(" "+e._s(t.body)+" ")])]}))],2):e._e()]:"merged"===e.branch.attributes.status?a("div",[a("h1",[e._v(e._s(e.branch.attributes.name))]),a("p",[e._v("This task has been integrated into the primary copy.")])]):"deleted"===e.branch.attributes.status?a("div",[a("h1",[e._v(e._s(e.branch.attributes.name))]),a("p",[e._v("This task has been deleted.")])]):e._e()],2):e._e()],1):a("router-view")},ue=[],ce=(a("a434"),a("5319"),function(e){Object(u["a"])(a,e);var t=Object(c["a"])(a);function a(){var e;return Object(i["a"])(this,a),e=t.apply(this,arguments),e.intervalId=-1,e.fileFilterDebounce=-1,e.fileFilterValue="",e.mode="files",e.flash="",e.newFileDirectory="",e.newFileName="",e}return Object(o["a"])(a,[{key:"fileFilter",get:function(){return this.fileFilterValue},set:function(e){var t=this;window.clearTimeout(this.fileFilterDebounce),this.fileFilterDebounce=window.setTimeout((function(){t.fileFilterValue=e}),300)}},{key:"branch",get:function(){return this.$store.state.data.branches&&this.$store.state.data.branches[this.$route.params.bid]?this.$store.state.data.branches[this.$route.params.bid]:null}},{key:"fileSets",get:function(){var e=this;if(this.$store.state.busy)return[{id:"Loading...",files:[]}];if(this.branch&&this.$store.state.data.files){var t=[],a=null;return this.branch.relationships.files&&(this.branch.relationships.files.data.forEach((function(r){if(r.id&&e.$store.state.data.files[r.id]){var n=e.$store.state.data.files[r.id];(""===e.fileFilter||e.contains(n.attributes.filename,e.fileFilter))&&(a&&a.id===n.attributes.path||(a&&t.push(a),a={id:n.attributes.path,files:[]}),a.files.push(n))}})),a&&t.push(a)),t}return[]}},{key:"changedSets",get:function(){if(this.branch&&this.branch.attributes.changes&&this.branch.attributes.changes.length>0){var e=[],t=null;return this.branch.attributes.changes.forEach((function(a){t&&t.id===a.attributes.path||(t&&e.push(t),t={id:a.attributes.path,files:[]}),t.files.push(a)})),t&&e.push(t),e}return[]}},{key:"isCurrentRoute",get:function(){return"branch"===this.$route.name}},{key:"mounted",value:function(){var e=Object(I["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$store.dispatch("loadBranch",{type:"branches",id:this.$route.params.bid});case 2:this.branch&&this.branch.attributes.changes&&this.branch.attributes.changes.length>0&&(this.mode="changed"),this.intervalId=window.setInterval(Object(I["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.branch){e.next=9;break}return e.prev=1,e.next=4,t.$store.dispatch("backgroundFetchSingle",t.branch);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e["catch"](1),e.t0.response&&404==e.t0.response.status&&(t.$store.commit("deleteObject",t.branch),t.$store.dispatch("loadBranches"),t.$router.push({name:"root"}));case 9:case"end":return e.stop()}}),e,null,[[1,6]])}))),1e4);case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"beforeDestroy",value:function(){window.clearInterval(this.intervalId)}},{key:"deleteBranch",value:function(e){e.preventDefault(),this.branch&&confirm("Deleting this task ("+this.branch.attributes.name+") will also delete any changes that have been made there and that have not been integrated into the default copy.\n\nThis cannot be undone.\n\nPlease confirm you wish to proceed.")&&(this.$store.dispatch("deleteBranch",this.branch),this.$router.push({name:"root"}))}},{key:"requestIntegration",value:function(){var e=Object(I["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.preventDefault(),!this.branch){e.next=5;break}return e.next=4,this.$store.dispatch("action",{obj:this.branch,action:"request-integration"});case 4:this.setFlash("The integration has been requested. The interface will take a few seconds for this to show.");case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"cancelIntegration",value:function(){var e=Object(I["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.preventDefault(),!this.branch){e.next=5;break}return e.next=4,this.$store.dispatch("action",{obj:this.branch,action:"cancel-integration"});case 4:this.setFlash("The integration has been cancelled. The interface will take a few seconds for this to show.");case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"rebase",value:function(){var e=Object(I["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.preventDefault(),!this.branch){e.next=5;break}return e.next=4,this.$store.dispatch("action",{obj:this.branch,action:"rebase"});case 4:this.setFlash("The changes from the primary copy have been integrated.");case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"rescan",value:function(){var e=Object(I["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.preventDefault(),!this.branch){e.next=7;break}return e.next=4,this.$store.dispatch("action",{obj:this.branch,action:"rescan"});case 4:return e.next=6,this.$store.dispatch("loadBranch",this.branch);case 6:this.setFlash("All files have been reloaded.");case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"setMode",value:function(e){this.mode=e}},{key:"setFlash",value:function(e){this.flash=e}},{key:"addFile",value:function(e){this.newFileDirectory=e,this.newFileName=""}},{key:"cancelAddFile",value:function(){this.newFileDirectory=""}},{key:"createFile",value:function(){var e=Object(I["a"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.preventDefault(),!this.newFileName||!this.branch){e.next=8;break}return a=("/"===this.newFileDirectory?this.newFileDirectory:this.newFileDirectory+"/")+this.newFileName,e.next=5,this.$store.dispatch("createSingle",{type:"files",attributes:{filename:a,path:this.newFileDirectory,name:this.newFileName},relationships:{branch:{data:{type:"branches",id:this.branch.id}}}});case 5:return e.next=7,this.$store.dispatch("fetchSingle",{type:"branches",id:this.branch.id});case 7:this.newFileDirectory="";case 8:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"ellipsisPath",value:function(e,t){if(e.length>t){var a=e.split("/");if(a[0].length+a[a.length-1].length>=t-5)return".../"+a[a.length-1];var r=a.splice(0,1),n=r[0].length;while(n<t-5&&a.length>0){var s=a.splice(a.length-1,1)[0];if(!(n+s.length<t-5))break;r.splice(1,0,s),n=n+s.length+1}return r[0]+"/.../"+r.slice(1).join("/")}return e}},{key:"contains",value:function(e,t){return e=e.toLowerCase().replace("-"," "),t=t.toLowerCase(),e.indexOf(t)>=0}}]),a}(h["c"]));ce=Object(l["a"])([Object(h["a"])({components:{AriaMenubar:w,AriaDialog:j}})],ce);var le=ce,he=le,de=Object(m["a"])(he,oe,ue,!1,null,null,null),pe=de.exports,fe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.file?a("div",{staticClass:"editor"},[e.fileData&&"text"===e.fileData.attributes.mode?a("text-editor",{attrs:{text:e.fileData.attributes.rawData},on:{save:e.save}}):e._e(),e.config&&e.fileData&&"tei"===e.fileData.attributes.mode?a("tei-editor",{attrs:{config:e.config,autoLoadCallback:e.loadFileDataCallback},on:{save:e.save}}):e._e(),e.savingFailed?a("div",{staticClass:"error",attrs:{role:"dialog"}},[a("h2",[e._v("Saving failed")]),e._m(0),a("p",[e._v("The most likely reason for this is that there is a problem with the network connection. Please check your network connection and then try saving again.")]),a("p",[e._v("If your network connection is working, then this is most likely an issue on the server side. Please contact your administrator. If you leave the browser window open, then when the issue is resolved by your administrator, you can try saving again and your changes should then be saved.")])]):e._e()],1):e._e()},be=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("p",[e._v("Unfortunately something went wrong saving the file. Your changes have "),a("strong",[e._v("not")]),e._v(" been saved on the server.")])}],ve=a("4979"),ge=a.n(ve),me=a("c154"),ke=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"text-editor flex vertical"},[a("nav",{staticClass:"shrink"},[a("ul",{attrs:{role:"menubar"}},[a("li",{attrs:{role:"presentation"}},[a("a",{attrs:{role:"menuitem"},on:{click:e.save}},[e._v(" Save ")])])])]),a("div",{ref:"editorElement"})])},we=[],ye=a("2909"),Ce=(a("25f0"),a("99af"),a("e1ea")),xe=a("02d1"),Ae=a("9638"),_e=a("2f80"),Oe=function(e){Object(u["a"])(a,e);var t=Object(c["a"])(a);function a(){var e;return Object(i["a"])(this,a),e=t.apply(this,arguments),e.editorView=null,e}return Object(o["a"])(a,[{key:"mounted",value:function(){this.loadEditor()}},{key:"save",value:function(e){e.preventDefault(),this.editorView&&this.$emit("save",this.editorView.state.doc.toString())}},{key:"extensions",value:function(){return[Object(Ae["a"])(),xe["e"].of([].concat(Object(ye["a"])(_e["a"]),Object(ye["a"])(Ae["b"])))]}},{key:"loadEditor",value:function(){if(!this.editorView&&this.$refs.editorElement){var e=Ce["e"].create({doc:"",extensions:this.extensions()});this.editorView=new xe["c"]({state:e,parent:this.$refs.editorElement})}if(this.editorView&&this.text){var t=Ce["e"].create({doc:this.text,extensions:this.extensions()});this.editorView.setState(t)}}}]),a}(h["c"]);Object(l["a"])([Object(h["b"])()],Oe.prototype,"text",void 0),Oe=Object(l["a"])([h["a"]],Oe);var je=Oe,Le=je,Ve=Object(m["a"])(Le,ke,we,!1,null,null,null),He=Ve.exports,Be=function(e){Object(u["a"])(a,e);var t=Object(c["a"])(a);function a(){var e;return Object(i["a"])(this,a),e=t.apply(this,arguments),e.fileData=null,e.savingFailed=!1,e}return Object(o["a"])(a,[{key:"file",get:function(){return this.$store.state.data.files&&this.$store.state.data.files[this.$route.params.fid]?this.$store.state.data.files[this.$route.params.fid]:null}},{key:"config",get:function(){return this.$store.state.config["tei-schema"]?this.$store.state.config["tei-schema"]:null}},{key:"mounted",value:function(){var e=this;this.$store.commit("setBusy",!0),z()({method:"GET",url:this.$store.state.config.api.baseURL+"/files/"+this.$route.params.fid,headers:{"X-Authorization":this.$store.state.userId+" "+this.$store.state.userToken,"X-Include-Data":!0}}).then((function(t){e.fileData=t.data.data,e.$store.commit("setBusy",!1)}),(function(t){e.$store.commit("setBusy",!1),401===t.response.status&&(e.$store.commit("setUserId",""),e.$store.commit("setUserToken",""),e.$store.commit("setLoggedIn",""),e.$router.push({name:"login"}))}))}},{key:"save",value:function(){var e=Object(I["a"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.fileData){e.next=16;break}return e.prev=1,this.savingFailed=!1,a=ge()(this.fileData),a.attributes.rawData=t,this.$store.commit("setBusy",!0),e.next=8,z()({method:"PATCH",url:this.$store.state.config.api.baseURL+"/files/"+this.$route.params.fid,headers:{"X-Authorization":this.$store.state.userId+" "+this.$store.state.userToken,"X-Include-Data":!0},data:{data:a}});case 8:this.$store.commit("setBusy",!1),e.next=16;break;case 11:e.prev=11,e.t0=e["catch"](1),this.savingFailed=!0,this.$store.commit("setBusy",!1),e.t0.response&&401===e.t0.response.status&&(this.$store.commit("setUserId",""),this.$store.commit("setUserToken",""),this.$store.commit("setLoggedIn",""),this.$router.push({name:"login"}));case 16:case"end":return e.stop()}}),e,this,[[1,11]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"loadFileDataCallback",value:function(e){this.fileData&&this.fileData.attributes.rawData&&e(this.fileData.attributes.rawData)}}]),a}(h["c"]);Be=Object(l["a"])([Object(h["a"])({components:{TextEditor:He,TeiEditor:me["TeiEditor"]}})],Be);var $e=Be,De=$e,Me=Object(m["a"])(De,fe,be,!1,null,null,null),Re=Me.exports;r["a"].use(D["a"]);var Ie=[{path:"/",name:"root",component:U},{path:"/login",name:"login",component:ie},{path:"/branches/:bid",name:"branch",component:pe,children:[{path:"files/:fid",name:"file",component:Re}]}],Te=new D["a"]({mode:"history",base:"/ui/",routes:Ie}),Se=Te;r["a"].config.productionTip=!1;var Fe=document.querySelector("#DigiEditConfig");if(Fe){var Ne=JSON.parse(Fe.innerHTML);te.commit("setConfig",Ne),te.dispatch("init")}new r["a"]({router:Se,store:te,render:function(e){return e($)}}).$mount("#app")}});
//# sourceMappingURL=app.6cdb37a8.js.map